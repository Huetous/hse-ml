* Чтобы запустить приложение может понадобиться создать conda среду
* В репо есть файл со средой: `env.yaml`

***
[StreamLit Hub Link](https://dugudkov-hse-ml-1.streamlit.app/)
***

**Что было сделано (кратко по этапам)**
1. Анализ и подготовка данных
    * Проведён анализ значений признаков
    * Проведен базовый анализ с помощью ProfileReport
    * Проанализованы распределения train и test
    * Обнаружены и удалены дубликаты
    * Неправильно определенные типы данных для признаков были исправлены
    * Пропуски были заполнены медианой
    * Проанализованы корреляции признаков (Пирсон, Спирман, phik)
2. Бейзлайн-модель на вещественных признаках
    * Обучена линейная регрессия
    * Посчитаны базовые метрики качества (MSE, RMSE, R2)
    * Признаки были стандартизованы. Не повлияло на качество.
    * Обучена Lasso. Не лучше бейзлайна.
    * Подбор гиперпараметров с помощью GridSearchCV
    * Обучение ElasticNet
3. Добавление категориальных признаков
    * Обработка признаков
    * Кодирование с помощью OneHotEncoder

**Какие результаты были получены (метрики + интерпретация)**

В таблице ниже, описаны все обученные модели.
| model | features | r2 |
| --- | --- | --- |
| Linear Regression | numerical| 0.6157 |
| Linear Regression | scaled numerical | 0.6157 |
| Lasso | scaled numerical | 0.6157 |
| Lasso (Grid Search) | scaled numerical | 0.6020 |
| ElasticNet (Grid Search) | scaled numerical | 0.6020 |
| Ridge (Grid Search) | scaled numerical, categorical, feature engineering | 0.7761 |
| Ridge (Grid Search) | scaled numerical, categorical | 0.7881 |

* Бейзлайн показал умеренное качество
* Стандартизация не повляила на качество
* Регуляриция не повляила на качество
* Добавление категориальных признаков сильно улучшило качество

**Что дало наибольший прирост качества**

Самый большой вклад дали:
* Добавление категориальных признаков

**Что сделать не удалось и почему (и почему это нормально)**
* Признаки вида groupby не дали особого прироста, хоть я и пробовал разные варианты. Не всегда можно заранее сказать, что выстрелит - нужно пробовать.
* Существенно поднять R2, но я не успел сделать feature engineering до конца, попробовать другие подходы.

**Оценка разработанного сервиса**
* насколько приложение удобно в использовании
  * Достаточно удобно, все в одном лендинге. Много функционала по вводу и графикам.
* что получилось визуализировать хорошо, а что — менее удачно
  * Графики, текст, таблицы - все хорошо визуализируется. Что мне не понравилось, так это эстетическая сторона. Вроде как нет возможности центрировать или выравнивать блоки в приложении - выглядит коряво. Но, с другой стороны, тут в приоритете скорость и легкость, а не полный функционал.
* какие ограничения или проблемы вы заметили
  * Я сделал несколько вкладок, но как я понял, вычисления запускаются на всех сразу.
  Т.е. если мне вкладка не нужна, я все равно жду пока она отработает. Я реализовал подход с RadioButton, он выглядит менее эстетично, но зато код выполняется только для выбранной вкладки. Но если выбрать повторно, то вычисление повторяется.
* какие улучшения планируете в следующей итерации
  * Я не успел разобраться с багом в предсказании модели. Ошибок нет, но значения очень странные.
